# Скрипты

!> Перечень доступных методов, их параметры, а также логика использования еще будет значительно меняться

В данной статье описан набор методов, которые можно использовать в скриптах из обработки выгрузки в XML.

?> Дополнительный примеры есть в папке scripts репозитория

### ТипыМодулей()

**Описание:** Возвращает структуру с типами модулей конфигурации.

**Возвращаемое значение:** `Структура` - структура с ключами:

- `МодульФормы` - модуль формы
- `МодульОбъекта` - модуль объекта
- `МодульМенеджера` - модуль менеджера
- `ОбщийМодуль` - общий модуль

**Пример использования:**

```bsl
ТипМодуля = ТипыМодулей().МодульФормы;
```

## Формы

### ПолучитьОсновнуюФорму()

**Описание:** Возвращает основную форму.

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка дерева изменений

**Пример использования:**

```bsl
// Получение основной формы
ОсновнаяФорма = ПолучитьОсновнуюФорму();

// Использование основной формы
МодульФормы = ПолучитьМодуль(ТипыМодулей().МодульФормы, ОсновнаяФорма);
```

### СоздатьФорму(СтрокаОбъект, Имя)

**Описание:** Создает форму.

**Параметры:**

- `СтрокаОбъект` - `ДанныеФормыЭлементДерева` - строка объекта конфигурации
- `Имя` - `Строка` - имя формы

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка дерева изменений

**Пример использования:**

```bsl
// Создание основной формы
СтрокаОбъект = СоздатьПолучитьОбъектКонфигурации("Справочник", "Контрагенты");
ОсновнаяФорма = СоздатьФорму(СтрокаОбъект, "ОсновнаяФорма");
```

### ОбработчикиСобытийЭлементовФормы(СтрокаЭлемент)

!> Пока поддерживаются только формы.

**Описание:** Возвращает перечень обработчиков событий элемента формы.

**Параметры:**

- `СтрокаЭлемент` - `ДанныеФормыЭлементДерева` - строка дерева изменений элемента формы

**Возвращаемое значение:** `Структура` - перечень названий обработчиков

**Пример использования:**

```bsl
// Использование конкретного обработчика
УстановитьОбработчикСобытияФормы(
    ОсновнаяФорма,
    ОбработчикиСобытийЭлементовФормы(ОсновнаяФорма).ПриСозданииНаСервере,
    "ПриСозданииНаСервере"
);
```

### УстановитьОбработчикСобытияФормы(СтрокаФорма, ИмяСобытия, ИмяМетода = Неопределено)

**Описание:** Устанавливает обработчик события формы.

**Параметры:**

- `СтрокаФорма` - `ДанныеФормыЭлементДерева` - строка формы
- `ИмяСобытия` - `Строка` - имя события формы
- `ИмяМетода` - `Строка` - имя метода-обработчика (необязательный, если не указан, то будет использовано имя события)

**Пример использования:**

```bsl
// Установка обработчика события
УстановитьОбработчикСобытияФормы(
    ОсновнаяФорма,
    ОбработчикиСобытийЭлементовФормы(ОсновнаяФорма).ПриСозданииНаСервере
);

// Установка обработчика с автоматическим именем метода
УстановитьОбработчикСобытияФормы(
    ОсновнаяФорма,
    ОбработчикиСобытийЭлементовФормы(ОсновнаяФорма).ПриОткрытии
);
```

### СоздатьЭлементФормы(СтрокаРодитель, ИмяЭлемента, ТипЭлемента, ВидЭлемента = Неопределено)

**Описание:** Создает элемент формы.

**Параметры:**

- `СтрокаРодитель` - `ДанныеФормыЭлементДерева` - строка формы
- `ИмяЭлемента` - `Строка` - имя элемента формы
- `ТипЭлемента` - `Строка` - тип элемента формы
- `ВидЭлемента` - `Строка` - вид элемента формы (необязательный)

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка элемента формы

**Пример использования:**

```bsl
// Создание группы
ЭлементГруппа = СоздатьЭлементФормы(ОсновнаяФорма, "ГруппаОсновная", "ГруппаФормы", "ОбычнаяГруппа");

// Создание поля ввода
ЭлементФамилия = СоздатьЭлементФормы(ЭлементГруппа, "Фамилия", "ПолеФормы", "ПолеВвода");

// Создание кнопки
ЭлементКнопка = СоздатьЭлементФормы(ЭлементГруппа, "Заполнить", "КнопкаФормы");
```

### СоздатьРеквизитФормы(СтрокаФорма, Имя, ОписаниеТипов, СтрокаРодитель = Неопределено)

**Описание:** Создает реквизит формы.

**Параметры:**

- `СтрокаФорма` - `ДанныеФормыЭлементДерева` - строка формы
- `Имя` - `Строка` - имя реквизита формы
- `ОписаниеТипов` - `Структура` - описание типов реквизита, см `СоздатьОписаниеТипов`
- `СтрокаРодитель` - `ДанныеФормыЭлементДерева` - строка табличной части

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка реквизита формы

**Пример использования:**

```bsl
// Создание реквизита формы
Реквизит = СоздатьРеквизитФормы(ОсновнаяФорма, "Фамилия", СоздатьОписаниеТипов("Строка"));

// Создание табличной части
РеквизитТаблица = СоздатьРеквизитФормы(ОсновнаяФорма, "Товары", СоздатьОписаниеТипов("ТаблицаЗначений"));

// Создание реквизита табличной части
РеквизитНоменклатура = СоздатьРеквизитФормы(ОсновнаяФорма, "Номенклатура", СоздатьОписаниеТипов("Справочник.Номенклатура"), РеквизитТаблица);
```

### УстановитьСвойствоЭлементаФормы(СтрокаЭлементФормы, Имя, Значение, Тип = Неопределено)

## Модули

### ПолучитьМодуль(ТипМодуля, Источник)

**Описание:** Получает модуль конфигурации.

**Параметры:**

- `ТипМодуля` - `Строка` - тип модуля
- `Источник` - `ДанныеФормыЭлементДерева`, `Строка` - источник для создания модуля. Для общего модуля источником является строка с названием модуля

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка дерева изменений

**Пример использования:**

```bsl
// Получение модуля формы
МодульФормы = ПолучитьМодуль(ТипыМодулей().МодульФормы, ОсновнаяФорма);

// Получение модуля объекта
МодульОбъекта = ПолучитьМодуль(ТипыМодулей().МодульОбъекта, ОсновнойОбъект);

// Получение общего модуля
ОбщийМодуль = ПолучитьМодуль(ТипыМодулей().ОбщийМодуль, "МойОбщийМодуль");
```

### СоздатьПолучитьМетод(СтрокаМодуль, Имя, Область, ЭтоФункция = Ложь)

**Описание:** Создает или получает метод в модуле конфигурации.

**Параметры:**

- `СтрокаМодуль` - `ДанныеФормыЭлементДерева` - строка дерева изменений модуля
- `Имя` - `Строка` - имя метода
- `Область` - `Строка` - область модуля для размещения метода
- `ЭтоФункция` - `Булево` - признак функции/процедуры (по умолчанию `Ложь`)

**Возвращаемое значение:** `Структура` - параметры созданного или найденного метода

**Пример использования:**

```bsl
// Создание метода в модуле формы
МодульФормы = ПолучитьМодуль(ТипыМодулей().МодульФормы, ОсновнаяФорма);
ПроцедураПриСозданииНаСервере = СоздатьПолучитьМетод(
    МодульФормы,
    "ПриСозданииНаСервере",
    "ОбработчикиСобытийФормы",
    Ложь
);

// Создание функции
ФункцияПолучитьДанные = СоздатьПолучитьМетод(
    МодульФормы,
    "ПолучитьДанные",
    "СлужебныеПроцедурыИФункции",
    Истина
);
```

### ДобавитьПараметрВМетод(Метод, Имя, ЗначениеПоУмолчанию = Неопределено, ПоЗначению = Ложь, Описание = Неопределено)

**Описание:** Добавляет параметр в метод.

**Параметры:**

- `Метод` - `Структура` - параметры метода
- `Имя` - `Строка` - имя параметра
- `ЗначениеПоУмолчанию` - `Строка` - значение по умолчанию (необязательный)
- `ПоЗначению` - `Булево` - передача по значению или ссылке (по умолчанию `Ложь`)
- `Описание` - `Строка` - описание параметра (необязательный)

**Возвращаемое значение:** `Структура` - описание добавленного параметра

**Пример использования:**

```bsl
// Добавление параметра к методу
ДобавитьПараметрВМетод(Метод, "Отказ");
```

### УстановитьТелоМетода(Метод, Текст)

**Описание:** Устанавливает тело метода с отступами.

**Параметры:**

- `Метод` - `Структура` - параметры метода
- `Текст` - `Строка` - текст тела метода

**Пример использования:**

```bsl
// Установка тела метода
УстановитьТелоМетода(Метод, "Сообщить(""Привет"");");

// Установка многострочного тела метода
ТекстМетода =
    "Если Условие Тогда
    |   Сообщить(""Условие выполнено"");
    |   КонецЕсли;";
УстановитьТелоМетода(Метод, ТекстМетода);
```

### ДобавитьКТелуМетода(Метод, Текст)

**Описание:** Добавляет текст к телу метода с отступами.

**Параметры:**

- `Метод` - `Структура` - параметры метода
- `Текст` - `Строка` - текст для добавления

**Пример использования:**

```bsl
// Добавление к телу метода
ДобавитьКТелуМетода(Метод, "Сообщить(""Привет"");");
```

## Объекты конфигурации

### ПолучитьОсновнойОбъект()

**Описание:** Возвращает основной объект, владелец основной формы.

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка дерева изменений

**Пример использования:**

```bsl
// Получение основного объекта
ОсновнойОбъект = ПолучитьОсновнойОбъект();

// Использование основного объекта
МодульОбъекта = ПолучитьМодуль(ТипыМодулей().МодульОбъекта, ОсновнойОбъект);
```

### СоздатьПолучитьОбъектКонфигурации(Тип, Имя)

**Описание:** Создает или получает объект конфигурации

**Параметры:**

- `Тип` - `Строка` - тип объекта конфигурации (Справочник, Документ, и т.д.)
- `Имя` - `Строка` - имя объекта конфигурации

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка дерева изменений объекта конфигурации

**Пример использования:**

```bsl
// Создание справочника
СправочникКонтрагенты = СоздатьПолучитьОбъектКонфигурации("Справочник", "Контрагенты");

// Создание документа
ДокументРеализация = СоздатьПолучитьОбъектКонфигурации("Документ", "Реализация");

// Создание перечисления
ПеречислениеПол = СоздатьПолучитьОбъектКонфигурации("Перечисление", "Пол");
```

### СоздатьПолучитьРеквизитОбъектаКонфигурации(СтрокаОбъект, Имя, ОписаниеТипов, СтрокаРодитель = Неопределено)

**Описание:** Создает или получает реквизит объекта конфигурации.

**Параметры:**

- `СтрокаОбъект` - `ДанныеФормыЭлементДерева` - строка объекта конфигурации
- `Имя` - `Строка` - имя реквизита
- `ОписаниеТипов` - `Структура` - описание типов реквизита, см `СоздатьОписаниеТипов`
- `СтрокаРодитель` - `ДанныеФормыЭлементДерева` - строка табличной части

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка дерева изменений

**Пример использования:**

```bsl
// Создание реквизита объекта
СтрокаКонтрагент = СоздатьПолучитьОбъектКонфигурации("Справочник", "Контрагенты");
Реквизит = СоздатьПолучитьРеквизитОбъектаКонфигурации(
    СтрокаКонтрагент,
    "ПолноеНаименование",
    СоздатьОписаниеТипов("Строка")
);

// Создание реквизита с числовым типом
РеквизитДоговор = СоздатьПолучитьРеквизитОбъектаКонфигурации(
    СтрокаКонтрагент,
    "Договор",
    СоздатьОписаниеТипов("Справочник.Договоры")
);
```

### СоздатьЗначениеОбъектаКонфигурации(СтрокаОбъект, Имя, Представление = Неопределено)

**Описание:** Создает значение перечисления.

**Параметры:**

- `СтрокаОбъект` - `ДанныеФормыЭлементДерева` - строка объекта конфигурации
- `Имя` - `Строка` - имя значения
- `Представление` - `Строка` - представление значения (необязательный)

**Возвращаемое значение:** `ДанныеФормыЭлементДерева` - строка дерева изменений

**Пример использования:**

```bsl
// Создание значений перечисления
ПеречислениеПол = СоздатьПолучитьОбъектКонфигурации("Перечисление", "Пол");
ЗначениеПеречисления = СоздатьЗначениеОбъектаКонфигурации(ПеречислениеПол, "Мужской", "Мужской пол");
ЗначениеПеречисления = СоздатьЗначениеОбъектаКонфигурации(ПеречислениеПол, "Женский", "Женский пол");
```

### УстановитьСвойствоОбъектаКонфигурации(СтрокаОбъект, Имя, Значение)

**Описание:** Устанавливает свойство объекта конфигурации (пока не реализовано).

**Параметры:**

- `СтрокаОбъект` - `ДанныеФормыЭлементДерева` - строка объекта конфигурации
- `Имя` - `Строка` - имя свойства
- `Значение` - `ДанныеФормыЭлементДерева` - строка формы

**Пример использования:**

```bsl
// Установка основной формы объекта
СтрокаКонтрагент = СоздатьПолучитьОбъектКонфигурации("Справочник", "Контрагенты");
СтрокаОсновнаяФорма = СоздатьФорму(СтрокаКонтрагент, "ОсновнаяФорма");
УстановитьСвойствоОбъектаКонфигурации(
    СтрокаКонтрагент,
    ТипыФорм().ОсновнаяФормаОбъекта,
    СтрокаОсновнаяФорма
);
```

### ЕстьРеквизитОбъектаКонфигурации(ТипОбъекта, ИмяОбъекта, ИмяРеквизита, ЭтаТабличнаяЧасть, ИмяТабличнойЧасти = Неопределено)

**Описание:** Проверяет существование реквизита в объекте конфигурации.

**Параметры:**

- `ТипОбъекта` - `Строка` - тип объекта конфигурации
- `ИмяОбъекта` - `Строка` - имя объекта конфигурации
- `ИмяРеквизита` - `Строка` - имя реквизита
- `ЭтаТабличнаяЧасть` - `Булево` - признак табличной части
- `ИмяТабличнойЧасти` - `Строка` - имя табличной части (необязательный)

**Возвращаемое значение:** `Булево` - `Истина`, если реквизит существует

**Пример использования:**

```bsl
// Проверка существования реквизита
ЕстьРевизитФамилия = ЕстьРеквизитОбъектаКонфигурации("Справочник", "Контрагенты", "Фамилия", Ложь);

// Проверка существования реквизита табличной части
ЕстьРеквизитТаблицы = ЕстьРеквизитОбъектаКонфигурации(
    "Документ",
    "Реализация",
    "Количество",
    Истина,
    "Товары"
);
```

### ЕстьОбъектКонфигурации(Тип, Имя)

**Описание:** Проверяет существование объекта конфигурации.

**Параметры:**

- `Тип` - `Строка` - тип объекта конфигурации
- `Имя` - `Строка` - имя объекта конфигурации

**Возвращаемое значение:** `Булево` - `Истина`, если объект существует

**Пример использования:**

```bsl
// Проверка существования объекта
ЕстьКонтрагенты = ЕстьОбъектКонфигурации("Справочник", "Контрагенты");
```

### ЭтоСтандартныйРеквизит(ТипОбъекта, ИмяРеквизита)

**Описание:** Проверяет, является ли реквизит стандартным реквизитом.

**Параметры:**

- `ТипОбъекта` - `Строка` - тип объекта конфигурации
- `ИмяРеквизита` - `Строка` - имя реквизита

**Возвращаемое значение:** `Булево` - `Истина`, если реквизит является стандартным реквизитом

**Пример использования:**

```bsl
// Проверка стандартных реквизитов
ЭтоСтандартныйРеквизит = ЭтоСтандартныйРеквизит("Справочник", "Наименование");
```

### ПолучитьРазделМетаданныхПоИмени(Имя)

**Описание:** Получает раздел метаданных конфигурации по имени.

**Параметры:**

- `Имя` - `Строка` - имя раздела метаданных

**Возвращаемое значение:** `Структура` - раздел метаданных конфигурации со следующими полями:

- `Имя` - `Строка` - имя раздела метаданных (например, "Справочник", "Документ")
- `ИмяМнож` - `Строка` - имя раздела во множественном числе (например, "Справочники", "Документы")
- `Представление` - `Строка` - представление раздела для отображения
- `ОсновнаяФорма` - `Строка` - имя основной формы раздела
- `ВнутреннееИмя` - `Строка` - внутреннее имя раздела на английском языке
- `ВнутреннееИмяМнож` - `Строка` - внутреннее имя раздела во множественном числе
- `Картинка` - `Картинка` - картинка для отображения раздела
- `ДоступенКакОсновнойОбъект` - `Булево` - признак доступности как основного объекта
- `СтандартныеРеквизиты` - `Структура` - стандартные реквизиты раздела

**Пример использования:**

```bsl
// Получение раздела метаданных справочников
РазделСправочники = ПолучитьРазделМетаданныхПоИмени("Справочник");

// Получение раздела метаданных документов
РазделДокументы = ПолучитьРазделМетаданныхПоИмени("Документ");

// Использование информации о разделе
ИмяРаздела = РазделСправочники.Имя;
ПредставлениеРаздела = РазделСправочники.Представление;
```

### СоздатьОписаниеТипов(Тип)

**Описание:** Создает структуру описания типов для реквизита.

**Параметры:**

- `Тип` - `Строка` - тип данных

**Возвращаемое значение:** `Структура` - описание типов со следующими свойствами:

- `ДлинаСтроки` - `Число` - длина строки
- `ЧастиДаты` - `Число` - части даты
- `ДлинаЧисла` - `Число` - длина числа
- `ТочностьЧисла` - `Число` - точность числа
- `Типы` - `Массив` - массив строк с названиями типов

**Пример использования:**

```bsl
// Создание описания типов для строки
ОписаниеТипов = СоздатьОписаниеТипов("Строка");
ОписаниеТипов.ДлинаСтроки = 150;

// Создание описания типов для числа
ОписаниеТиповЧисло = СоздатьОписаниеТипов("Число");
ОписаниеТиповЧисло.ДлинаЧисла = 15;
ОписаниеТиповЧисло.ТочностьЧисла = 3;

// Создание описания типов для даты
ОписаниеТиповДата = СоздатьОписаниеТипов("Дата");
ОписаниеТиповДата.ЧастиДаты = ЧастиДаты.Дата;

// Создание описания типов для таблицы значений
ОписаниеТиповТаблица = СоздатьОписаниеТипов("ТаблицаЗначений");
```

**Описание:** Устанавливает свойство элемента формы.

**Параметры:**

- `СтрокаЭлементФормы` - `ДанныеФормыЭлементДерева` - строка элемента формы
- `Имя` - `Строка` - имя свойства
- `Значение` - `Произвольный` - значение свойства
- `Тип` - `Строка` - тип системного перечисления, см `ТипыСистемныеПеречисления`

**Пример использования:**

```bsl
// Установка доступности элемента
УстановитьСвойствоЭлементаФормы(ЭлементФамилия, "Доступность", Ложь);

// Установка видимости элемента
УстановитьСвойствоЭлементаФормы(ЭлементФамилия, "Видимость", Истина);

// Установка заголовка элемента
УстановитьСвойствоЭлементаФормы(ЭлементФамилия, "Заголовок", "Фамилия");

// Установка цвета элемента
УстановитьСвойствоЭлементаФормы(
    ЭлементФамилия,
    "ЦветФона",
    "СветлоЖелтый",
    ТипыСистемныеПеречисления().WebЦвета
);
```
